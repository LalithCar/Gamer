// Replace your googleSignIn function with this more detailed version
function googleSignIn() {
    // Show a loading message
    document.getElementById('login-error').textContent = "Connecting to Google...";
    document.getElementById('login-error').style.display = 'block';
    document.getElementById('login-error').style.color = 'blue';
    
    signInWithPopup(auth, provider)
        .then((result) => {
            const user = result.user;
            // Hide login container and show game container
            document.getElementById('login-container').classList.add('hidden');
            document.getElementById('game-container').classList.remove('hidden');
            
            // Display user info
            document.getElementById('user-display').textContent = `Logged in as: ${user.displayName || user.email}`;
            console.log("Logged in as:", user.displayName);
            
            // Clear any error message
            document.getElementById('login-error').style.display = 'none';
        })
        .catch((error) => {
            // Detailed error logging
            console.error("Login failed:", error);
            console.error("Error code:", error.code);
            console.error("Error message:", error.message);
            
            // User-friendly error message based on error code
            let errorMessage = "Login failed. ";
            
            switch (error.code) {
                case 'auth/popup-blocked':
                    errorMessage += "Please allow popups for this website.";
                    break;
                case 'auth/popup-closed-by-user':
                    errorMessage += "You closed the login popup. Please try again.";
                    break;
                case 'auth/unauthorized-domain':
                    errorMessage += "This domain is not authorized in Firebase. Add it to your Firebase Console.";
                    break;
                case 'auth/cancelled-popup-request':
                    errorMessage += "Multiple popup requests were triggered. Please try again.";
                    break;
                case 'auth/operation-not-allowed':
                    errorMessage += "Google sign-in is not enabled in Firebase. Enable it in your Firebase Console.";
                    break;
                default:
                    errorMessage += error.message || "Please try again later.";
            }
            
            document.getElementById('login-error').textContent = errorMessage;
            document.getElementById('login-error').style.display = 'block';
            document.getElementById('login-error').style.color = 'red';
        });
}
